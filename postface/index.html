<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>README</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>

<style>
  .markdown-body {
    box-sizing: border-box;
    min-width: 200px;
    max-width: 980px;
    margin: 0 auto;
    padding: 45px;
  }
  p.caption{
    display:none;
  }
  img {width: 100%}

  @media (max-width: 767px) {
    .markdown-body {
      padding: 15px;
    }
  }
</style>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://kaityo256.github.io/sevendayshpc/github-markdown.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<article class="markdown-body">
<h1 id="おわりに">おわりに</h1>
<p>2003年、自分が博士課程の学生の頃、地球シミュレータのアカウントを手に入れることができた。
当時、地球シミュレータは二位以下に大差をつけて圧倒的な存在として君臨する、世界No.
1のスパコンだった、
私は地球シミュレータを使うため、あるプロジェクトに所属していた。自分で言うのもなんだが、それなりに戦力として期待されていたのではないかと思う。
しかし僕はD3であり、博士論文を書くのに忙しかった。
さらに当時、地球シミュレータはネットワーク越しの利用が許されておらず、使いたければ端末を予約して新杉田にある海洋研まで行く必要があった。
これは言い訳になってしまうが、自分には博士論文を書きつつ、遠くにある端末まで行ってコードを開発、チューニングする余力はなかった。
結局、ほとんど地球シミュレータを使うことができないまま卒業、就職し、プロジェクトも終了。卒業した年(2004年)の11月、地球シミュレータもTop500の一位の座をBlue
Geneに明渡した。</p>
<p>「せっかく世界一のスパコンを触る機会があったのに、ほとんど触ることができなかった」</p>
<p>この悔しい思いは、「次に日本が国策スパコンを作ったら、絶対に使いこなしてやる」という強い思いとして残った。</p>
<p>時は流れて2011年、僕はまだ一般公開前の「京」の評価をするため、家族を連れて半年ほど神戸に詰めていた。僕はかかわっていないのだが、ちょうどこの時「京」を使ったHPLの測定が行われていた。2011年6月、京は<a
href="http://www.riken.jp/pr/topics/2011/20110620/">地球シミュレータ以来、7年ぶりとなるTOP500一位</a>を獲得する。さらに紆余曲折あって2015年3月、僕は自分の提案したプロジェクトが認められ、とある論文を投稿するために、「京」にフルノードジョブを投げていた。普段、「京」は多くのユーザで共有して使っており、フルノードジョブが実行できる機会は月に1度しかなかった。論文の締切が4月頭で、1月から3回のチャンスがあった。事前に4096ノード程度で問題ないことを確認していたジョブだったが、82944ノード実行時に二度失敗してしまい、後がなかった(ちなみに失敗原因は、ノード数に比例して大きくなるテンポラリバッファを使っており、4096ノードでは特に問題とならないが、82944ノード実行するとメモリを食いつぶしてしまう、というものだった)。ジョブを投入すると、ジョブの開始時と終了時にメールが飛んでくる。したがって、ジョブの開始メールと終了メールが同時に飛んできたら「あ、ジョブがこけたな」ということがわかる。
三度目のチャレンジ、ジョブの開始メールが飛んできて、でも終了メールが飛んでこない。これは今、「京」フルノードを自分のジョブが占有して走っていることを示す。リアルに「あのスパコンで走ってるジョブ、俺のなんすよwww」状態である。しかし、ジョブが終了するまでは安心できない。ジョブ終了メールが飛んでくるまで、祈るような気持ちで待つ。そしてジョブ終了後、正常終了を示すログを見たあと、ダンプファイルを可視化したところ、そこには大きな泡があった(当時、僕は分子動力学法による気泡生成シミュレーションをしていた)。「このジョブが失敗したら論文の投稿ができない」というジョブは、なんとか無事に完走してくれ、おかげで論文を投稿することができた。当時の緊張と、失敗時の落胆、三度目のジョブ実行中の高揚感を今でも思い出せる。</p>
<p>仕事柄、日常的にスパコンに触れているのだが、スパコンには夢があると思う。スパコンには、普通のパソコンではできないようなことができそうな雰囲気がある。
最初、僕がスパコンを使い始めた時には「こんなもの自分に使えるんだろうか」という不安感があった。
しかし、使ってみるとわりとあっさりと使えて「スパコンを使いこなしてる俺スゲー！」という気持ちになった。
さらに使っていくと、どうもスパコンはもっと可能性を秘めていそうなのに、「自分が使いこなしていない感」が強くなってきた。
今でも、「スパコンのポテンシャルを引き出した！面白い計算ができた！」と納得できる仕事はできていない。
でもやっぱり、スパコンは面白いと思う。</p>
<p>スパコンには大きなお金がからむため、ニュースなどで話題となるのはネガティブなものが多い印象である。せっかくスパコンで面白い計算ができたり、面白い技術が開発されたりしてもあまり取り上げられず、「二位じゃだめなんでしょうか」発言に代表されるような、スパコンそのものの楽しさから離れたトピックが話題となることが多い。その際、あまりスパコンに詳しくなさそうな人による「解説」に、多くの人が賛同したりしているのを見て、それなりにスパコンと長い付き合いがある身としては歯がゆい思いをしていた。どんな分野でもそうだと思うが、実際に手を動かして使ってみなければ「スパコンとはどういうものか」は体感できない。
値段、ベンチマークの数値や理論性能値など、そういうものでスパコンを議論するのは自由だが、少なくとも僕はそれで「スパコン」を理解できる気はしない。
この文章も、「スパコンを知らない人がざっと読んでわかった気になること」を目的として書いたものではない。並列計算というのは思ったより簡単であり、誰でもすぐスパコンが使えるようになること、でもそのあと「スパコンを使い倒そう」とすると、とたんに様々な「闇」があって難しいこと、でもそれが面白いこと、そんなこんなを実感して欲しい、僕はそういう気持ちで書いた。</p>
<p>近い将来、学会の懇親会などで「『一週間でなれる！スパコンプログラマ』を読んでスパコンプログラマになりました」と、見知らぬ学生さんに突然話かけられるのを夢見て、筆を置くことにする。</p>
<p>2018年　Hiroshi Watanabe</p>
<h2 id="謝辞">謝辞</h2>
<p>この記事は、<a href="https://github.com/tanakamura">tanakamura</a>
さんの <a
href="https://tanakamura.github.io/pllp/docs/">実践的低レベルプログラミング</a>に影響されて書き始めたものです。
angel_p_57さんにMPIにおけるバッファリングについて教えていただきました。fujita_d_hさんにはBlueGene/LのL1エラー訂正について議論していただきました。n_IMRCさんには、行列積におけるTLBミスの論文を教えていただきました。まだこの記事が書きかけだったときにたくさん星をつけてくださった皆様、Twitterなどで感想を寄せてくださった皆様、ありがとうございます。みなさんのポジティブな反応がなければ書き続けられませんでした。</p>
<p>本稿を読んで「スパコンを使ってみよう」と思う人が一人でも増えたなら幸いです。</p>
</article>
</body>
</html>
